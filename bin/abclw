#!/usr/bin/env zsh

if [ -z ${CHI_SHARE_DIR} ]; then
    echo 'You need to set CHI_SHARE_DIR before running this script.'
    exit 1
fi

ABCL_JAR=${CHI_SHARE_DIR}/abcl-1.3.3/abcl.jar
JAVA_BIN=/usr/bin/java

if [ $# -eq 0 ]; then
  exec rlwrap -b "[]()'\" " --remember -c -f ~/.abcl-completions -H ~/.abcl-history -s 1000000 ${JAVA_BIN} -server -Xrs -cp ${ABCL_JAR} org.armedbear.lisp.Main
else
  exec $ABCL "$@"
fi
